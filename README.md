# profile-service

A lightweight **Profile Service** built with Laravel. This microservice provides public information, news, and authenticated user profile endpoints used by other services (or for local testing).

---

## ğŸš€ Features
- Public endpoints to fetch service info and news
- Authenticated endpoints protected by a JWT middleware (`auth.jwt`)
- OpenAPI (Swagger) documentation generated by **l5-swagger**
- Lightweight and easy to run locally for testing

---

## ğŸ“‚ Project layout (important files)
- `routes/api.php` â€” API routes
- `app/Http/Controllers/Api` â€” API controllers (`PublicController`, `UserController`, `ProfileController`)
- `app/Http/Middleware/AuthJwtMiddleware.php` â€” JWT validation middleware
- `app/Swagger/Schemas.php` â€” l5-swagger annotations (OpenAPI info & schemas)
- `storage/api-docs/api-docs.json` â€” generated OpenAPI JSON

---

## ğŸ“‹ Requirements
- PHP >= 8.1
- Composer
- (Optional) MySQL if you enable persistence for this service
- A local web server (Laravel Sail / Valet / php artisan serve)

---

## âš™ï¸ Installation & Setup
```bash
# Clone the repository
git clone https://github.com/irfan-farooq-dev/profile-service.git
cd profile-service

# Install PHP dependencies
composer install

# Copy environment file
cp .env.example .env

# Generate app key
php artisan key:generate
```

Edit `.env` as needed (e.g., `APP_URL`, database credentials).

### JWT public key
The middleware reads the public key from `config('jwt.public_key_path')` â€” set this in `.env` or `config/jwt.php` so `AuthJwtMiddleware` can validate tokens.

---

## ğŸ“– API Documentation (Swagger)
This project uses **l5-swagger** to generate OpenAPI docs from PHPDoc annotations.

- Generate docs:
```bash
php artisan l5-swagger:generate
```
- Open the UI (default):
```
http://localhost:8000/api/documentation
```
- The generated JSON is written to: `storage/api-docs/api-docs.json`.

> Tip: Use the **Authorize** button in Swagger UI and enter `Bearer <JWT>` to test protected endpoints.

---

## ğŸ”Œ Available endpoints
- GET `/api/public/info` â€” Public service info (JSON)
- GET `/api/public/news` â€” Public news list (JSON array)
- GET `/api/user/profile` â€” Authenticated user profile (requires `Authorization: Bearer <token>`)
- GET `/api/user/stats` â€” Authenticated user stats (requires `Authorization: Bearer <token>`)
- GET `/api/clear` â€” Clear caches and refresh config (returns plain text)

### Example curl
```bash
# Public info
curl http://localhost:8000/api/public/info

# Protected profile (replace <TOKEN>)
curl -H "Authorization: Bearer <TOKEN>" http://localhost:8000/api/user/profile
```

---

## ğŸ§© Notes
- Middleware alias is registered in `bootstrap/app.php` as `'auth.jwt' => App\Http\Middleware\AuthJwtMiddleware::class`.
- Move OpenAPI annotations to `app/Swagger/Schemas.php` to keep controllers clean.
- If you changed routes or controllers, regenerate docs with `php artisan l5-swagger:generate`.

---

## ğŸ¤ Contributing
Contributions are welcome. Please open an issue or submit a pull request.

